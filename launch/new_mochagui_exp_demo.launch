<launch>

  <arg name="launch_planner"   default="false"/>
  <!-- <arg name="launch_infinitam" default="false"/> -->
  <arg name="launch_car"       default="true"/>
  <arg name="launch_sensors"   default="true"/>
  <arg name="launch_vicon"     default="true"/> <!-- true: vicon, false: liosam -->
  <arg name="launch_rviz"      default="false"/>

  <arg name="enable_debug"    default="false"/>
  <arg name="enable_valgrind" default="false"/>
  <arg name="launch_prefix"   default="gdb -ex run --args" if="$(eval arg('enable_debug') and not arg('enable_valgrind') and arg('launch_manager'))"/>
  <arg name="launch_prefix"   default="valgrind "          if="$(eval arg('enable_valgrind') and not arg('enable_debug') and arg('launch_manager'))"/>
  <arg name="launch_prefix"   default=""                   if="$(eval not arg('enable_debug') and not arg('enable_valgrind'))"/>

  <node pkg="CarPlanner" type="run_mochagui.sh" name="mochagui" output="screen" if="$(arg launch_planner)"/>

  <!-- <include file="$(find infinitam)/launch/demo.launch" if="$(arg launch_infinitam)">
    <arg name="enable_debug"        value="$(arg enable_debug)"/>
    <arg name="convert_metric"      value="false"/>
    <arg name="publish_vertices"    value="false"/>
    <arg name="world_frame_id"      value="map"/>
    <arg name="camera_frame_id"     value="$(arg camera_frame_id)"/>
    <arg name="mesh_topic"          value="$(arg mesh_topic)"/>
    <arg name="depth_info_topic"    value="$(arg depth_info_topic)"/>
    <arg name="depth_topic"         value="$(arg depth_topic)"/>
    <arg name="rgb_info_topic"      value="$(arg rgb_info_topic)"/>
    <arg name="rgb_topic"           value="$(arg rgb_topic)"/>
    <arg name="enable_guess_from_tf_tree" value="$(arg enable_guess_from_tf_tree)"/>
  </include> -->

  <node pkg="rostopic" type="rostopic" name="default_waypoint_publisher" args="pub /waypoints carplanner_msgs/Waypoints -r 1 --file=$(find carplanner_msgs)/launch/straight_on_edge.waypoints"  output="screen" if="true"/>

  <include file="$(find drive_control)/launch/remote_control.launch" if="$(arg launch_car)">
    <arg name="control_mode"  value="1"/>
    <arg name="control_scale" value="10.0"/>
  </include>

  <node pkg="carplanner_tools" type="controlcommand2drivecommand" name="control2drive" if="$(arg launch_car)">
    <remap from="control_command" to="/command"/>
    <remap from="drive_command"   to="/planner_command"/>
  </node>

  <include file="$(find carplanner_msgs)/launch/sensors.launch" if="$(arg launch_sensors)">
  </include>

  <include file="$(find vicon_tools)/launch/vicon_demo.launch" if="$(arg launch_vicon)">
    <arg name="launch_vicon"         value="true"/>
    <arg name="launch_odom_tools"    value="true"/>
    <arg name="launch_rviz"          value="false"/>
    <arg name="fixed_frame"          value="map"/>
    <arg name="mocap_frame"          value="mocap"/>
    <arg name="mocap_object"         value="N02"/>
    <arg name="base_link_frame"      value="base_link"/>
  </include>
  <include file="$(find carplanner_msgs)/launch/lio_sam.launch" unless="$(arg launch_vicon)">
  </include>

  <node pkg="rviz" type="rviz" name="mochagui_exp_rviz" args="-d $(find carplanner_msgs)/rviz/carplanner.rviz" if="$(arg launch_rviz)"/>

</launch>
